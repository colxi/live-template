import{Keypath}from"./core-keypath.js";import{Bindings}from"./core-bindings.js";import{Directive}from"./core-directive.js";import{Directives}from"./core-directives.js";import{Placeholder}from"./core-placeholder.js";const Subscribe={model:function(e,i){console.log("Subscribe.model(): ",e),Bindings.placeholders.hasOwnProperty(e)&&Bindings.placeholders[e].forEach(i=>{if(i.nodeType===Node.ELEMENT_NODE&&i.hasAttributes()){let t=Bindings.elements.get(i);for(let r in t)if(t.hasOwnProperty(r))if(Directive.isDirectiveName(r)&&Directive.exist(r)){const t=Directive.nameUnpack(r),o=Keypath.resolve(e);Directives[t.name].hasOwnProperty("subscribe")&&Directives[t.name].subscribe(i,e,t.arguments,o)}else _DEBUG_.lightblue("Subscribe.model(): Updating placeholder in Attribute ...",r+"="+t[r]),i.setAttribute(r,Placeholder.populateString(t[r]))}else _DEBUG_.lightblue("Subscribe.model(): Updating placeholder in texNode...",e),i.textContent=Placeholder.populateString(Bindings.elements.get(i))});const t=Keypath.resolveContext(e);if(Array.isArray(t.context)){let i=e.split("."),r=i.splice(-1);i=i.join("."),Bindings.iterators.hasOwnProperty(i)&&"length"===r[0]&&Bindings.iterators[i].forEach((e,r)=>Directives.for.subscribe(r,i,["for"],t.context))}},dom:function(e){switch(console.log("Subscribe.dom():","Element("+e.action+"ed)",e.keyPath),e.action){case"add":case"update":Subscribe.model(e.keyPath,e.object)}}};export{Subscribe};